var he=Object.defineProperty,be=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable;var ae=(e,s,l)=>s in e?he(e,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[s]=l,k=(e,s)=>{for(var l in s||(s={}))ke.call(s,l)&&ae(e,l,s[l]);if(te)for(var l of te(s))Fe.call(s,l)&&ae(e,l,s[l]);return e},O=(e,s)=>be(e,ye(s));import{i as Se,j as qe,f as le,Q as xe,a as re}from"./QBtn.5c02f783.js";import{c as ue,f as ze}from"./render.ce2d7a1b.js";import{b as Ce,h as se}from"./format.3e32b8d9.js";import{c,h as u,g as A,r as q,M as ie,k as ne,S as Ue,w as we,f as Be,i as je,af as Le,Z as $e}from"./index.f310304c.js";import{u as Ne,a as De}from"./QCard.b3936020.js";const Oe=O(k({},Se),{min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean}),M=50,de=2*M,ce=de*Math.PI,Re=Math.round(ce*1e3)/1e3;var Pe=ue({name:"QCircularProgress",props:O(k({},Oe),{value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean}),setup(e,{slots:s}){const{proxy:{$q:l}}=A(),_=qe(e),d=c(()=>{const p=(l.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(l.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-p}deg)`:`rotate3d(0, 0, 1, ${p-90}deg)`}}),b=c(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),v=c(()=>de/(1-e.thickness/2)),j=c(()=>`${v.value/2} ${v.value/2} ${v.value} ${v.value}`),U=c(()=>Ce(e.value,e.min,e.max)),a=c(()=>ce*(1-(U.value-e.min)/(e.max-e.min))),f=c(()=>e.thickness/2*v.value);function x({thickness:p,offset:z,color:w,cls:B}){return u("circle",{class:"q-circular-progress__"+B+(w!==void 0?` text-${w}`:""),style:b.value,fill:"transparent",stroke:"currentColor","stroke-width":p,"stroke-dasharray":Re,"stroke-dashoffset":z,cx:v.value,cy:v.value,r:M})}return()=>{const p=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&p.push(u("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:M-f.value/2,cx:v.value,cy:v.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&p.push(x({cls:"track",thickness:f.value,offset:0,color:e.trackColor})),p.push(x({cls:"circle",thickness:f.value,offset:a.value,color:e.color}));const z=[u("svg",{class:"q-circular-progress__svg",style:d.value,viewBox:j.value,"aria-hidden":"true"},p)];return e.showValue===!0&&z.push(u("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},s.default!==void 0?s.default():[u("div",U.value)])),u("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:_.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:U.value},ze(s.internal,z))}}});function L(e,s,l,_){const d=[];return e.forEach(b=>{_(b)===!0?d.push(b):s.push({failedPropValidation:l,file:b})}),d}function R(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),ne(e)}const Te={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ie=["rejected"];function Ee({editable:e,dnd:s,getFileInput:l,addFilesToQueue:_}){const{props:d,emit:b,proxy:v}=A(),j=q(null),U=c(()=>d.accept!==void 0?d.accept.split(",").map(r=>(r=r.trim(),r==="*"?"*/":(r.endsWith("/*")&&(r=r.slice(0,r.length-1)),r.toUpperCase()))):null),a=c(()=>parseInt(d.maxFiles,10)),f=c(()=>parseInt(d.maxTotalSize,10));function x(r){if(e.value)if(r!==Object(r)&&(r={target:null}),r.target!==null&&r.target.matches('input[type="file"]')===!0)r.clientX===0&&r.clientY===0&&ie(r);else{const F=l();F&&F!==r.target&&F.click(r)}}function p(r){e.value&&r&&_(null,r)}function z(r,F,$,D){let i=Array.from(F||r.target.files);const y=[],S=()=>{y.length>0&&b("rejected",y)};if(d.accept!==void 0&&U.value.indexOf("*/")===-1&&(i=L(i,y,"accept",n=>U.value.some(h=>n.type.toUpperCase().startsWith(h)||n.name.toUpperCase().endsWith(h))),i.length===0))return S();if(d.maxFileSize!==void 0){const n=parseInt(d.maxFileSize,10);if(i=L(i,y,"max-file-size",h=>h.size<=n),i.length===0)return S()}d.multiple!==!0&&i.length>0&&(i=[i[0]]),i.forEach(n=>{n.__key=n.webkitRelativePath+n.lastModified+n.name+n.size});const I=$.map(n=>n.__key);if(i=L(i,y,"duplicate",n=>I.includes(n.__key)===!1),i.length===0)return S();if(d.maxTotalSize!==void 0){let n=D===!0?$.reduce((h,E)=>h+E.size,0):0;if(i=L(i,y,"max-total-size",h=>(n+=h.size,n<=f.value)),i.length===0)return S()}if(typeof d.filter=="function"){const n=d.filter(i);i=L(i,y,"filter",h=>n.includes(h))}if(d.maxFiles!==void 0){let n=D===!0?$.length:0;if(i=L(i,y,"max-files",()=>(n++,n<=a.value)),i.length===0)return S()}if(S(),i.length>0)return i}function w(r){R(r),s.value!==!0&&(s.value=!0)}function B(r){ne(r),r.relatedTarget!==j.value&&(s.value=!1)}function P(r){R(r);const F=r.dataTransfer.files;F.length>0&&_(null,F),s.value=!1}function T(r){if(s.value===!0)return u("div",{ref:j,class:`q-${r}__dnd absolute-full`,onDragenter:R,onDragover:R,onDragleave:B,onDrop:P})}return Object.assign(v,{pickFiles:x,addFiles:p}),{pickFiles:x,addFiles:p,onDragover:w,processFiles:z,getDndNode:T,maxFilesNumber:a,maxTotalSizeNumber:f}}function oe(e){return(e*100).toFixed(2)+"%"}const Me=O(k(k({},Ne),Te),{label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean}),ve=[...Ie,"start","finish","added","removed"];function Ae(e){const s=A(),{props:l,slots:_,emit:d,proxy:b}=s,{$q:v}=b,j=De(l,v);function U(t,o,m){if(t.__status=o,o==="idle"){t.__uploaded=0,t.__progress=0,t.__sizeLabel=se(t.size),t.__progressLabel="0.00%";return}if(o==="failed"){b.$forceUpdate();return}t.__uploaded=o==="uploaded"?t.size:m,t.__progress=o==="uploaded"?1:Math.min(.9999,t.__uploaded/t.size),t.__progressLabel=oe(t.__progress),b.$forceUpdate()}const a={files:q([]),queuedFiles:q([]),uploadedFiles:q([]),uploadedSize:q(0),updateFileStatus:U,isAlive(){return s.isDeactivated!==!0&&s.isUnmounted!==!0}};Object.assign(a,e({props:l,slots:_,emit:d,helpers:a}));const f=q(0),x=c(()=>l.disable!==!0&&l.readonly!==!0);a.isBusy===void 0&&(a.isBusy=q(!1));const p=q(!1),z=q(null),w=q(null);Ue(Le,Z);const{pickFiles:B,addFiles:P,onDragover:T,onDragleave:r,processFiles:F,getDndNode:$,maxFilesNumber:D,maxTotalSizeNumber:i}=Ee({editable:x,dnd:p,getFileInput:X,addFilesToQueue:Y}),y=c(()=>x.value===!0&&a.isUploading.value!==!0&&(l.multiple===!0||a.queuedFiles.value.length===0)&&(l.maxFiles===void 0||a.files.value.length<D.value)&&(l.maxTotalSize===void 0||f.value<i.value)),S=c(()=>x.value===!0&&a.isBusy.value!==!0&&a.isUploading.value!==!0&&a.queuedFiles.value.length>0),I=c(()=>f.value===0?0:a.uploadedSize.value/f.value),n=c(()=>oe(I.value)),h=c(()=>se(f.value)),E=c(()=>"q-uploader column no-wrap"+(j.value===!0?" q-uploader--dark q-dark":"")+(l.bordered===!0?" q-uploader--bordered":"")+(l.square===!0?" q-uploader--square no-border-radius":"")+(l.flat===!0?" q-uploader--flat no-shadow":"")+(l.disable===!0?" disabled q-uploader--disable":"")+(p.value===!0?" q-uploader--dnd":"")),fe=c(()=>"q-uploader__header"+(l.color!==void 0?` bg-${l.color}`:"")+(l.textColor!==void 0?` text-${l.textColor}`:""));we(a.isUploading,(t,o)=>{o===!1&&t===!0?d("start"):o===!0&&t===!1&&d("finish")});function pe(){l.disable===!1&&(a.abort(),a.uploadedSize.value=0,f.value=0,K(),a.files.value=[],a.queuedFiles.value=[],a.uploadedFiles.value=[])}function Q(){l.disable===!1&&G(["uploaded"],()=>{a.uploadedFiles.value=[]})}function W(){G(["idle","failed"],({size:t})=>{f.value-=t,a.queuedFiles.value=[]})}function G(t,o){if(l.disable===!0)return;const m={files:[],size:0},C=a.files.value.filter(g=>t.indexOf(g.__status)===-1?!0:(m.size+=g.size,m.files.push(g),g.__img!==void 0&&window.URL.revokeObjectURL(g.__img.src),!1));m.files.length>0&&(a.files.value=C,o(m),d("removed",m.files))}function H(t){l.disable||(t.__status==="uploaded"?a.uploadedFiles.value=a.uploadedFiles.value.filter(o=>o.__key!==t.__key):t.__status==="uploading"?t.__abort():f.value-=t.size,a.files.value=a.files.value.filter(o=>o.__key!==t.__key?!0:(o.__img!==void 0&&window.URL.revokeObjectURL(o.__img.src),!1)),a.queuedFiles.value=a.queuedFiles.value.filter(o=>o.__key!==t.__key),d("removed",[t]))}function K(){a.files.value.forEach(t=>{t.__img!==void 0&&window.URL.revokeObjectURL(t.__img.src)})}function X(){return w.value||z.value.getElementsByClassName("q-uploader__input")[0]}function Y(t,o){const m=F(t,o,a.files.value,!0);if(m===void 0)return;const C=X();C!=null&&(C.value=""),m.forEach(g=>{if(a.updateFileStatus(g,"idle"),f.value+=g.size,l.noThumbnails!==!0&&g.type.toUpperCase().startsWith("IMAGE")){const ee=new Image;ee.src=window.URL.createObjectURL(g),g.__img=ee}}),a.files.value=a.files.value.concat(m),a.queuedFiles.value=a.queuedFiles.value.concat(m),d("added",m),l.autoUpload===!0&&a.upload()}function me(){S.value===!0&&a.upload()}function N(t,o,m){if(t===!0){const C={type:"a",key:o,icon:v.iconSet.uploader[o],flat:!0,dense:!0};let g;return o==="add"?(C.onClick=B,g=Z):C.onClick=m,u(re,C,g)}}function Z(){return u("input",{ref:w,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:l.accept,multiple:l.multiple===!0?"multiple":void 0,capture:l.capture,onMousedown:ie,onClick:B,onChange:Y})}function _e(){return _.header!==void 0?_.header(V.value):[u("div",{class:"q-uploader__header-content column"},[u("div",{class:"flex flex-center no-wrap q-gutter-xs"},[N(a.queuedFiles.value.length>0,"removeQueue",W),N(a.uploadedFiles.value.length>0,"removeUploaded",Q),a.isUploading.value===!0?u(le,{class:"q-uploader__spinner"}):null,u("div",{class:"col column justify-center"},[l.label!==void 0?u("div",{class:"q-uploader__title"},[l.label]):null,u("div",{class:"q-uploader__subtitle"},[h.value+" / "+n.value])]),N(y.value,"add"),N(l.hideUploadBtn===!1&&S.value===!0,"upload",a.upload),N(a.isUploading.value,"clear",a.abort)])])]}function ge(){return _.list!==void 0?_.list(V.value):a.files.value.map(t=>u("div",{key:t.__key,class:"q-uploader__file relative-position"+(l.noThumbnails!==!0&&t.__img!==void 0?" q-uploader__file--img":"")+(t.__status==="failed"?" q-uploader__file--failed":t.__status==="uploaded"?" q-uploader__file--uploaded":""),style:l.noThumbnails!==!0&&t.__img!==void 0?{backgroundImage:'url("'+t.__img.src+'")'}:null},[u("div",{class:"q-uploader__file-header row flex-center no-wrap"},[t.__status==="failed"?u(xe,{class:"q-uploader__file-status",name:v.iconSet.type.negative,color:"negative"}):null,u("div",{class:"q-uploader__file-header-content col"},[u("div",{class:"q-uploader__title"},[t.name]),u("div",{class:"q-uploader__subtitle row items-center no-wrap"},[t.__sizeLabel+" / "+t.__progressLabel])]),t.__status==="uploading"?u(Pe,{value:t.__progress,min:0,max:1,indeterminate:t.__progress===0}):u(re,{round:!0,dense:!0,flat:!0,icon:v.iconSet.uploader[t.__status==="uploaded"?"done":"clear"],onClick:()=>{H(t)}})])]))}Be(()=>{a.isUploading.value===!0&&a.abort(),a.files.value.length>0&&K()});const J={pickFiles:B,addFiles:P,reset:pe,removeUploadedFiles:Q,removeQueuedFiles:W,removeFile:H,upload:me,abort:a.abort},V=c(()=>{const t={canAddFiles:y.value,canUpload:S.value,uploadSizeLabel:h.value,uploadProgressLabel:n.value};for(const o in a)t[o]=je(a[o])===!0?a[o].value:a[o];return k(k({},t),J)});return Object.assign(b,J),()=>{const t=[u("div",{class:fe.value},_e()),u("div",{class:"q-uploader__list scroll"},ge()),$("uploader")];a.isBusy.value===!0&&t.push(u("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[u(le)]));const o={ref:z,class:E.value};return y.value===!0&&Object.assign(o,{onDragover:T,onDragleave:r}),u("div",o,t)}}const Qe=()=>!0;function We(e){const s={};return e.forEach(l=>{s[l]=Qe}),s}const Ge=We(ve);var Ve=({name:e,props:s,emits:l,injectPlugin:_})=>ue({name:e,props:k(k({},Me),s),emits:$e(l)===!0?k(k({},Ge),l):[...ve,...l],setup(){return Ae(_)}});export{Ve as c};
